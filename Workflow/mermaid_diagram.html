
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mermaid Diagram</title>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script>
</head>
<body>
  <div class="mermaid">
    
graph TD
    %% Node Definitions
    A([Start Program])
    B[Set Program Title 'Credit Data Update Engine']
    C[Prepare screen labels - example: Upload File Parameters]
    D{"File source is 'Presentation Server'?"}
    E1[Enable Presentation Server path field, disable Application Server path]
    E2[Enable Application Server path field, disable Presentation Server path]
    F[/Display selection screen and await user input/execution/]
    G[Validate User Inputs - example: mandatory paths]
    H{"Are inputs valid?"}
    I[Set internal 'abort' flag]
    J[Initialize Application Log for run]
    K[Validate source path and compile list of files]
    L[Filter file list - remove '.' and '..']
    M_START{"Loop: Has more files?"}
    N[/Read current file's data into memory/]
    O[Process credit data updates from file]
    P{"Was file processing successful?"}
    Q1[Log success message in Application Log]
    Q2[Log error details in Application Log]
    R[/Write erroneous data to error file/]
    S[Move processed file to backup directory]
    T[Collect results for final display]
    U[Retrieve all messages from Application Log]
    V[/Display Execution Log to user/]
    W([End Program])

    %% Connections
    A --> B
    B --> C
    C --> D
    D -- "Yes" --> E1
    D -- "No" --> E2
    E1 --> F
    E2 --> F
    F --> G
    G --> H
    H -- "Yes" --> J
    H -- "No" --> I
    I --> U
    J --> K
    K --> L
    L --> M_START
    M_START -- "Yes (Has more files)" --> N
    M_START -- "No (No more files)" --> U
    N --> O
    O --> P
    P -- "Yes" --> Q1
    P -- "No" --> Q2
    Q1 --> S
    Q2 --> R
    R --> S
    S --> T
    T --> M_START
    U --> V
    V --> W


  </div>
</body>
</html>
